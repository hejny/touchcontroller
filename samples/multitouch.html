<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Sample of TouchController</title>
</head>
<body>


<canvas id="scene" width="500" height="500" style="border: 2px solid black"></canvas>


<script type="text/javascript" src="../dist/touchcontroller.browser.js"></script>
<script type="text/javascript">

    var scene = document.getElementById('scene');
    var ctx = scene.getContext('2d');
    ctx.lineWidth = 10;
    ctx.lineCap = "round";


    var touchController = new TouchController.TouchController(scene);
    touchController.addListener(new TouchController.listeners.TouchListener);
    touchController.addListener(new TouchController.listeners.MouseListener);
    var multiTouchController = new TouchController.MultiTouchController(
        touchController,
        function (position) {
            return Math.round(position.x / 100);
        }
    );
    console.log(multiTouchController);

    multiTouchController.multiTouches.subscribe(function (multitouch) {

        console.log(multitouch);

        var color = '#' + Math.floor(Math.random() * 16777215).toString(16);

        multitouch.touches.subscribe(function (touch) {

            /*ctx.strokeStyle = color;
            ctx.beginPath();
            ctx.moveTo(0, 0);
            ctx.lineTo(touch.firstPosition.x, touch.firstPosition.y);
            ctx.stroke();*/


            /*var lastPosition = touch.firstPosition;*/

            touch.positions.subscribe(function (position) {

                var lastPosition = multitouch.ongoingTouches[0].lastPosition;
                for(var i=1,l=multitouch.ongoingTouches.length;i<l;i++){
                    var position = multitouch.ongoingTouches[i].lastPosition;

                    ctx.strokeStyle = color;
                    ctx.beginPath();
                    ctx.moveTo(lastPosition.x, lastPosition.y);
                    ctx.lineTo(position.x, position.y);
                    ctx.stroke();

                    lastPosition = position;
                }


                //console.log(multitouch.touches.toArray());

                /*ctx.strokeStyle = color;
                ctx.beginPath();
                ctx.moveTo(lastPosition.x, lastPosition.y);
                ctx.lineTo(position.x, position.y);
                ctx.stroke();
                lastPosition = position;*/
            });

        });
    });
</script>


</body>
</html>